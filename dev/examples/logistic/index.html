<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Logistic Regression · GeNIOS.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://tjdiamandis.github.io/GeNIOS.jl/examples/logistic/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeNIOS.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../constrained-ls/">Constrained Least Squares</a></li><li><a class="tocitem" href="../huber/">Huber Fitting</a></li><li><a class="tocitem" href="../lasso/">Lasso</a></li><li class="is-active"><a class="tocitem" href>Logistic Regression</a><ul class="internal"><li><a class="tocitem" href="#Generating-the-problem-data"><span>Generating the problem data</span></a></li><li><a class="tocitem" href="#Logistic-Solver"><span>Logistic Solver</span></a></li><li><a class="tocitem" href="#MLSolver-interface"><span>MLSolver interface</span></a></li><li><a class="tocitem" href="#Results"><span>Results</span></a></li></ul></li><li><a class="tocitem" href="../portfolio/">Markowitz Portfolio Optimization</a></li><li><a class="tocitem" href="../signal/">Signal Decomposition</a></li></ul></li><li><a class="tocitem" href="../../guide/">User Guide</a></li><li><a class="tocitem" href="../../method/">Solution method</a></li><li><a class="tocitem" href="../../api/">API reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Logistic Regression</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Logistic Regression</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tjdiamandis/GeNIOS.jl/blob/main/examples/logistic.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p>The source files for all examples can be found in <a href="https://github.com/tjdiamandis/GeNIOS.jl/tree/main/examples">/examples</a>.</p><h1 id="Logistic-Regression"><a class="docs-heading-anchor" href="#Logistic-Regression">Logistic Regression</a><a id="Logistic-Regression-1"></a><a class="docs-heading-anchor-permalink" href="#Logistic-Regression" title="Permalink"></a></h1><p>This example sets up a <span>$\ell_1$</span>-regularized logistic regression problem using the <code>MLSolver</code> interface provided by GeNIOS.</p><p>Specifically, we want to solve the problem</p><p class="math-container">\[\begin{array}{ll}
\text{minimize}     &amp; \sum_{i=1}^N \log(1 + \exp(a_i^T x)) + \gamma \|x\|_1
\end{array}\]</p><pre><code class="language-julia hljs">using GeNIOS
using Random, LinearAlgebra, SparseArrays</code></pre><h2 id="Generating-the-problem-data"><a class="docs-heading-anchor" href="#Generating-the-problem-data">Generating the problem data</a><a id="Generating-the-problem-data-1"></a><a class="docs-heading-anchor-permalink" href="#Generating-the-problem-data" title="Permalink"></a></h2><pre><code class="language-julia hljs">Random.seed!(1)
N, n = 2_000, 4_000
Ã = sprandn(N, n, 0.2)
@views [normalize!(Ã[:, i]) for i in 1:n-1]
Ã[:,n] .= 1.0

xstar = zeros(n)
inds = randperm(n)[1:100]
xstar[inds] .= randn(length(inds))
b̃ = sign.(Ã*xstar + 1e-1 * randn(N))
b = zeros(N)
A = Diagonal(b̃) * Ã

γmax = norm(0.5*A&#39;*ones(N), Inf)
γ = 0.05*γmax</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.7000000000000002</code></pre><h2 id="Logistic-Solver"><a class="docs-heading-anchor" href="#Logistic-Solver">Logistic Solver</a><a id="Logistic-Solver-1"></a><a class="docs-heading-anchor-permalink" href="#Logistic-Solver" title="Permalink"></a></h2><p>The easiest way to solve this problem is to use our <code>LogisticSolver</code> interface.</p><pre><code class="language-julia hljs">λ1 = γ
λ2 = 0.0
solver = GeNIOS.LogisticSolver(λ1, λ2, A, b)
res = solve!(solver; options=GeNIOS.SolverOptions(use_dual_gap=true, dual_gap_tol=1e-4, verbose=true))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GeNIOS.GeNIOSResult{Float64}(:OPTIMAL, 1308.5532697157037, 1097.4094411058556, [1.9388905775875715e-5, 5.9654473270223e-5, 5.162263616823113e-5, 5.3722610821615196e-5, -7.280633640603425e-6, 3.7983020813087885e-5, -5.240925857016303e-5, 3.083563746314749e-5, 3.228465281846093e-5, -0.00016160198751140773  …  1.8841264872274726e-5, -4.322727892302269e-5, 3.297880109243481e-5, -3.666652528278776e-5, -1.760903167156862e-5, 1.5173320583361485e-5, 1.705605403184205e-5, -5.226735302936398e-6, 3.880945134286628e-5, -0.05113440175907365], [-0.0, -0.0, 0.0, -0.0, -0.0, -0.0, 0.0, 0.0, -0.0, 0.0  …  -0.0, -0.0, 0.0, -0.0, -0.0, -0.0, -0.0, 0.0, 0.0, -0.05115207111999842], [-0.18286998296257484, -0.5402331340149193, 0.027659434922889064, -0.2904239450040877, -0.46735358865419285, -0.2477878197797221, 0.5035583509959941, 0.26880097556835036, -0.15818441487943935, 0.5889074442358768  …  -0.6492698694434998, -0.07558224774244242, 0.5946353753402501, -0.17859599507528529, -0.06991613513897718, -0.39735346629613744, -0.1395423096129191, 0.15401422760554875, 0.013603646658570494, -1.7000000000000002], 8.39560419436773e-5, GeNIOS.GeNIOSLog{Float64, Vector{Float64}}([4.881425129542098, 4.6725998500994, 4.5634557511887195, 4.541331946183739, 4.503911720372876, 4.451323404064914, 4.40390480212738, 4.37406851850364, 4.350091269015744, 4.327184604973829  …  0.00029781234838747355, 0.007259595637426474, 0.00022731221863914075, 0.004807390730274438, 0.00017339683167923468, 0.00312038711802212, 0.00013325508844582937, 0.0020084641270971468, 0.00010593338018974395, 0.001366669416336365], [1383.000784031648, 1345.7140653461586, 1323.2994408791183, 1319.962796534635, 1317.5662186006268, 1316.040393320659, 1314.611715468881, 1313.4066673417258, 1312.3627567135266, 1311.5304495393905  …  1308.5534171365712, 1308.5533780671815, 1308.5533509781246, 1308.5533320998818, 1308.553314324661, 1308.5533014869113, 1308.5532910936931, 1308.5532836361226, 1308.5532777738713, 1308.5532733754578], [0.116255569, 0.145679311, 0.174755453, 0.203846296, 0.232976838, 0.26221808, 0.291402923, 0.321531466, 0.350892609, 0.379983251  …  1.886010136, 1.919095784, 1.952587933, 1.985877781, 2.019148329, 2.052472478, 2.085804126, 2.12301118, 2.160623235, 2.197707589], [0.04827507, 0.016083023, 0.015962823, 0.015986223, 0.016024723, 0.016087124, 0.015955823, 0.016735524, 0.016092523, 0.015972223  …  0.016021124, 0.019924328, 0.020013329, 0.019961929, 0.020073029, 0.020040729, 0.020081629, 0.024007334, 0.024057135, 0.023930535], [18.656616713588843, 17.76314446835697, 10.020083560919819, 7.374325875511078, 6.331663957960509, 5.923318304573992, 5.150053660493581, 4.01221487502098, 2.8951896679906177, 2.287076739998932  …  0.019487453238860523, 0.02101035066795309, 0.019389234023603864, 0.01524939344976948, 0.011178788968323323, 0.010042944028316897, 0.010882521222248807, 0.010899695804975374, 0.00936092314214398, 0.007067985388601786], [38.46858603345761, 32.344383200205726, 31.108193356093974, 30.430470608706436, 29.333777260521188, 28.17483953820797, 27.349156892581423, 26.82052466129365, 26.293480171209197, 25.62657881405529  …  0.08278424032276072, 0.07497625054308332, 0.0520367136361133, 0.05409476860835622, 0.039586715141180444, 0.03874040313103648, 0.02628151516652489, 0.024539611366565104, 0.018075252437016295, 0.0197933386497417], 0.57867564, 0.49598812, 2.235055743))</code></pre><h2 id="MLSolver-interface"><a class="docs-heading-anchor" href="#MLSolver-interface">MLSolver interface</a><a id="MLSolver-interface-1"></a><a class="docs-heading-anchor-permalink" href="#MLSolver-interface" title="Permalink"></a></h2><p>Under the hood, the LogisticSolver is just a wrapper around the MLSolver interface. We can see what it&#39;s doing below. To use the <code>MLSolver</code> interface, we just need to specify <span>$f$</span> and the regularization parameters. We also define the conjugate function <span>$f^*$</span>, defined as</p><p class="math-container">\[f^*(y) = \sup_x \{yx - f(x)\},\]</p><p>to use the dual gap convergence criterion.</p><pre><code class="language-julia hljs"># Logistic problem: min ∑ log(1 + exp(aᵢᵀx)) + γ||x||₁
f2(x) = GeNIOS.log1pexp(x)
df2(x) = GeNIOS.logistic(x)
d2f2(x) = GeNIOS.logistic(x) / GeNIOS.log1pexp(x)
f2conj(x::T) where {T} = (one(T) - x) * log(one(T) - x) + x * log(x)
λ1 = γ
λ2 = 0.0
solver = GeNIOS.MLSolver(f2, df2, d2f2, λ1, λ2, A, b; fconj=f2conj)
res = solve!(solver; options=GeNIOS.SolverOptions(use_dual_gap=true, dual_gap_tol=1e-4, verbose=true))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GeNIOS.GeNIOSResult{Float64}(:OPTIMAL, 1308.5532696536227, 1097.4093867016288, [5.853932463627633e-6, 7.701442598173021e-5, 5.969858235066496e-5, 5.224819035404637e-5, -1.326719885033753e-6, 4.415880945693554e-5, -5.723362586211548e-5, 3.537926508796653e-5, 2.994178026447472e-5, -0.00015694367944856668  …  7.307640471644649e-6, -5.312356623952758e-5, 2.5348911898639087e-5, -3.498420492617122e-5, -4.943547264848798e-6, 1.539240842338816e-5, 2.1821074414109057e-5, 1.280298265037416e-5, 4.2352482911635095e-5, -0.051133699089786426], [-0.0, -0.0, 0.0, -0.0, -0.0, -0.0, 0.0, 0.0, -0.0, 0.0  …  -0.0, -0.0, 0.0, -0.0, -0.0, -0.0, -0.0, 0.0, 0.0, -0.05114731401361272], [-0.18287373237957344, -0.5402077794319067, 0.02764764329407908, -0.2903922537864456, -0.46739546427473666, -0.24778781068008984, 0.5035544030529686, 0.26882783561604157, -0.15820273018287162, 0.588865625518377  …  -0.6492731065133809, -0.0756259914353349, 0.5946375500909133, -0.1786329610332451, -0.06994409184909707, -0.3973603809575926, -0.13958267506609132, 0.15400592848217648, 0.013554315141926112, -1.7000000000000002], 8.423628878161548e-5, GeNIOS.GeNIOSLog{Float64, Vector{Float64}}([4.8810977789152314, 4.671804244396793, 4.564459883862429, 4.541985416064159, 4.502345490961534, 4.44963246054728, 4.401779763645609, 4.372603226509353, 4.3492413219605215, 4.32672189703837  …  0.00029994924347788606, 0.005675865205083205, 0.0002271975828954039, 0.0037548410195088395, 0.00017265177983309308, 0.002448959318395475, 0.00013320027312873703, 0.0015971584664040423, 0.00010631724909539936, 0.001090085407234512], [1383.0130367504776, 1345.7055871577597, 1323.265021177218, 1319.9061531318318, 1317.5337924422186, 1316.036101427682, 1314.624186612935, 1313.4216257857975, 1312.37149241893, 1311.5317678151514  …  1308.5534137420561, 1308.5533756921357, 1308.553349124296, 1308.5533300823352, 1308.5533128727352, 1308.5533003446355, 1308.5532903860374, 1308.5532831858409, 1308.553277558703, 1308.5532732494191], [0.116452169, 0.145977812, 0.175171754, 0.204753897, 0.23453314, 0.263855883, 0.293281725, 0.322727165, 0.352104105, 0.381691045  …  1.890369693, 1.923430938, 1.956677783, 1.989616727, 2.022680872, 2.055740317, 2.088772462, 2.126925814, 2.165435866, 2.203364318], [0.04799257, 0.016143223, 0.016027023, 0.016244624, 0.016347023, 0.016078223, 0.016162024, 0.016144522, 0.016148322, 0.016267922  …  0.015987022, 0.019971527, 0.019994128, 0.019847827, 0.019926527, 0.019928127, 0.019918927, 0.024660833, 0.024915134, 0.024524133], [18.646806841972538, 17.770013775738548, 10.001742471668992, 7.375223438202064, 6.345761613093084, 5.9269325993210655, 5.147580023308744, 4.00494771882193, 2.893039765203076, 2.289147089186349  …  0.0189347721211324, 0.020151360172239265, 0.019118939191924228, 0.015755628469469967, 0.01183628342508614, 0.00994215777031467, 0.010334038583162073, 0.010628851522343288, 0.009578441402960111, 0.0075066267028087675], [38.46641333244801, 32.342534302840576, 31.12270933357789, 30.437938209217872, 29.329158376819162, 28.180944231562524, 27.36082991208085, 26.83945846223132, 26.316499481106813, 25.653891522153142  …  0.06658787799982045, 0.06252366110740781, 0.04122040214753007, 0.04497093488585361, 0.03321443028796, 0.03377544560089203, 0.02294058864991278, 0.021399151641995105, 0.015231659065602098, 0.017448887239930065], 0.45465856, 0.403324985, 2.240954669))</code></pre><h2 id="Results"><a class="docs-heading-anchor" href="#Results">Results</a><a id="Results-1"></a><a class="docs-heading-anchor-permalink" href="#Results" title="Permalink"></a></h2><pre><code class="language-julia hljs">rmse = sqrt(1/N*norm(A*solver.zk - b, 2)^2)
println(&quot;Final RMSE: $(round(rmse, digits=8))&quot;)
println(&quot;Dual gap: $(round(res.dual_gap, digits=8))&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Final RMSE: 0.59811275
Dual gap: 8.424e-5</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lasso/">« Lasso</a><a class="docs-footer-nextpage" href="../portfolio/">Markowitz Portfolio Optimization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Sunday 4 June 2023 21:55">Sunday 4 June 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
