<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Logistic Regression · GeNIOS.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://tjdiamandis.github.io/GeNIOS.jl/examples/logistic/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeNIOS.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../constrained-ls/">Constrained Least Squares</a></li><li><a class="tocitem" href="../huber/">Huber Fitting</a></li><li><a class="tocitem" href="../lasso/">Lasso</a></li><li class="is-active"><a class="tocitem" href>Logistic Regression</a><ul class="internal"><li><a class="tocitem" href="#Generating-the-problem-data"><span>Generating the problem data</span></a></li><li><a class="tocitem" href="#Logistic-Solver"><span>Logistic Solver</span></a></li><li><a class="tocitem" href="#MLSolver-interface"><span>MLSolver interface</span></a></li><li><a class="tocitem" href="#Results"><span>Results</span></a></li></ul></li><li><a class="tocitem" href="../portfolio/">Markowitz Portfolio Optimization</a></li><li><a class="tocitem" href="../signal/">Signal Decomposition</a></li></ul></li><li><a class="tocitem" href="../../guide/">User Guide</a></li><li><a class="tocitem" href="../../method/">Solution method</a></li><li><a class="tocitem" href="../../api/">API reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Logistic Regression</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Logistic Regression</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tjdiamandis/GeNIOS.jl/blob/main/examples/logistic.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p>The source files for all examples can be found in <a href="https://github.com/tjdiamandis/GeNIOS.jl/tree/main/examples">/examples</a>.</p><h1 id="Logistic-Regression"><a class="docs-heading-anchor" href="#Logistic-Regression">Logistic Regression</a><a id="Logistic-Regression-1"></a><a class="docs-heading-anchor-permalink" href="#Logistic-Regression" title="Permalink"></a></h1><p>This example sets up a <span>$\ell_1$</span>-regularized logistic regression problem using the <code>MLSolver</code> interface provided by GeNIOS.</p><p>Specifically, we want to solve the problem</p><p class="math-container">\[\begin{array}{ll}
\text{minimize}     &amp; \sum_{i=1}^N \log(1 + \exp(a_i^T x)) + \gamma \|x\|_1
\end{array}\]</p><pre><code class="language-julia hljs">using GeNIOS
using Random, LinearAlgebra, SparseArrays</code></pre><h2 id="Generating-the-problem-data"><a class="docs-heading-anchor" href="#Generating-the-problem-data">Generating the problem data</a><a id="Generating-the-problem-data-1"></a><a class="docs-heading-anchor-permalink" href="#Generating-the-problem-data" title="Permalink"></a></h2><pre><code class="language-julia hljs">Random.seed!(1)
N, n = 2_000, 4_000
Ã = sprandn(N, n, 0.2)
@views [normalize!(Ã[:, i]) for i in 1:n-1]
Ã[:,n] .= 1.0

xstar = zeros(n)
inds = randperm(n)[1:100]
xstar[inds] .= randn(length(inds))
b̃ = sign.(Ã*xstar + 1e-1 * randn(N))
b = zeros(N)
A = Diagonal(b̃) * Ã

γmax = norm(0.5*A&#39;*ones(N), Inf)
γ = 0.05*γmax</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.7000000000000002</code></pre><h2 id="Logistic-Solver"><a class="docs-heading-anchor" href="#Logistic-Solver">Logistic Solver</a><a id="Logistic-Solver-1"></a><a class="docs-heading-anchor-permalink" href="#Logistic-Solver" title="Permalink"></a></h2><p>The easiest way to solve this problem is to use our <code>LogisticSolver</code> interface.</p><pre><code class="language-julia hljs">λ1 = γ
λ2 = 0.0
solver = GeNIOS.LogisticSolver(λ1, λ2, A, b)
res = solve!(solver; options=GeNIOS.SolverOptions(use_dual_gap=true, dual_gap_tol=1e-4, verbose=true))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GeNIOS.GeNIOSResult{Float64}(:OPTIMAL, 1308.5532604279244, 1097.3698991958508, [-6.1149773090670796e-6, 1.3400238981964934e-6, -3.4929978667889053e-6, 2.571544662317052e-6, 1.9013644051212734e-6, 5.488403989865917e-7, -3.989958655701621e-6, -2.291371663474031e-6, 5.377632122251644e-6, -9.59004400513094e-7  …  7.235975094282004e-7, 2.378961852797988e-6, -1.866494861690714e-6, 2.562131571925428e-6, 3.2472155482569357e-6, 3.4553138407801965e-6, 5.715768628637833e-6, 5.682491225261951e-7, -1.4216820232675133e-6, -0.05112964637209034], [-0.0, -0.0, 0.0, -0.0, -0.0, -0.0, 0.0, 0.0, -0.0, 0.0  …  -0.0, -0.0, 0.0, -0.0, -0.0, -0.0, -0.0, 0.0, 0.0, -0.0511296463720905], [-0.36493880069895634, -1.0800859468550983, 0.05481938992479745, -0.5804317003913685, -0.9342700950443161, -0.4953733945144212, 1.0072457752538029, 0.5372385597963385, -0.3163545773291658, 1.1775077813284465  …  -1.2983049084955673, -0.15074919362306413, 1.1893290689577942, -0.35869160244027304, -0.14031710205136638, -0.7943711491501586, -0.2791305584386621, 0.3075252318026916, 0.02637631464861226, -3.4000000000000004], 9.841733448341406e-5, GeNIOS.GeNIOSLog{Float64, Vector{Float64}}([4.9290553605160845, 4.824352315720872, 4.672497988611483, 4.576466174317781, 4.5175413716085675, 4.475197462245268, 4.438079715780779, 4.4061979756167595, 4.380822001787506, 4.3580230689235435  …  0.00038062821246281155, 0.00033113136758680054, 0.000286893131490357, 0.0002483414194181012, 0.00021552428466276206, 0.00018789001688308439, 0.00016461395625955904, 0.0001447861958322653, 0.00012756403287890708, 0.00011226444208174156], [1386.2943611198643, 1372.5546725820354, 1349.9720734932293, 1333.792902963314, 1325.0227891184193, 1320.388534693608, 1317.7518679321213, 1316.0182796411539, 1314.7415622671579, 1313.681018958955  …  1308.5533008564084, 1308.5532897140051, 1308.553281424532, 1308.5532753061127, 1308.5532708142682, 1308.553267524996, 1308.5532651188569, 1308.553263358491, 1308.553262069194, 1308.5532611233302], [0.148147071, 0.180351643, 0.216214852, 0.251540812, 0.285671361, 0.321568674, 0.355863338, 0.390469632, 0.427880684, 0.464229738  …  3.059161045, 3.120566868, 3.186584444, 3.519481999, 3.589148833, 3.659931676, 3.728943745, 3.79607093, 3.867380025, 3.938018351], [0.057508907, 0.014599047, 0.019120464, 0.019019255, 0.01799056, 0.018501307, 0.017760439, 0.018011462, 0.020024048, 0.019271078  …  0.05230253, 0.045342147, 0.049388745, 0.05280738, 0.052246425, 0.053708068, 0.052180219, 0.050414145, 0.055207015, 0.054702473], [5.7905e-5, 4.1904e-5, 3.6703e-5, 3.6403e-5, 3.2203e-5, 4.0004e-5, 4.0703e-5, 3.2203e-5, 3.7303e-5, 3.7703e-5  …  3.5503e-5, 3.5803e-5, 3.8904e-5, 4.3605e-5, 3.9003e-5, 3.9404e-5, 3.6304e-5, 3.7404e-5, 3.4603e-5, 3.5503e-5], [11.76462170490228, 12.587593456638585, 8.734786975320073, 4.765965211431164, 2.644453892919143, 2.178324703497392, 2.01176050399924, 1.67613795307231, 1.2725403994479567, 0.8852451626251252  …  0.0012495237339815643, 0.0010434798207467316, 0.0008724798980035655, 0.0007279365000647302, 0.0006059711394193327, 0.0005056757182457897, 0.000425213461193326, 0.00036140107283849827, 0.0003106214552302134, 0.0002695843134577119], [42.08325550311181, 35.54984856392289, 32.096964657133334, 30.65311934758319, 29.728358939458385, 28.92214939826572, 28.24867694104512, 27.736873777172796, 27.345632825208806, 27.00783217378592  …  0.007171858210051276, 0.006154971488947944, 0.005265694513466184, 0.004502728745630861, 0.003858007601541425, 0.003317311956904834, 0.0028643682215522526, 0.0024829319387549608, 0.0021582842281528073, 0.0018781342122753334], 0.687969285, 0.52579582, 4.008702204))</code></pre><h2 id="MLSolver-interface"><a class="docs-heading-anchor" href="#MLSolver-interface">MLSolver interface</a><a id="MLSolver-interface-1"></a><a class="docs-heading-anchor-permalink" href="#MLSolver-interface" title="Permalink"></a></h2><p>Under the hood, the LogisticSolver is just a wrapper around the MLSolver interface. We can see what it&#39;s doing below. To use the <code>MLSolver</code> interface, we just need to specify <span>$f$</span> and the regularization parameters. We also define the conjugate function <span>$f^*$</span>, defined as</p><p class="math-container">\[f^*(y) = \sup_x \{yx - f(x)\},\]</p><p>to use the dual gap convergence criterion.</p><pre><code class="language-julia hljs"># Logistic problem: min ∑ log(1 + exp(aᵢᵀx)) + γ||x||₁
f2(x) = GeNIOS.log1pexp(x)
df2(x) = GeNIOS.logistic(x)
d2f2(x) = GeNIOS.logistic(x) / GeNIOS.log1pexp(x)
f2conj(x::T) where {T} = (one(T) - x) * log(one(T) - x) + x * log(x)
λ1 = γ
λ2 = 0.0
solver = GeNIOS.MLSolver(f2, df2, d2f2, λ1, λ2, A, b; fconj=f2conj)
res = solve!(solver; options=GeNIOS.SolverOptions(use_dual_gap=true, dual_gap_tol=1e-4, verbose=true))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GeNIOS.GeNIOSResult{Float64}(:OPTIMAL, 1308.5532604348678, 1097.369971388317, [-6.182072856772116e-6, 1.2523135849118665e-6, -3.5672677781584747e-6, 2.4588296027192323e-6, 1.881175915450949e-6, 7.08455416495067e-7, -4.05141627886685e-6, -2.2575659706971295e-6, 5.492644705443723e-6, -1.026120771068562e-6  …  6.003213316242566e-7, 2.3557078843350413e-6, -1.7577752458865322e-6, 2.6808880077710607e-6, 3.338858488525443e-6, 3.610841044500024e-6, 5.5535522285419135e-6, 5.5523583911383e-7, -1.6769490978006061e-6, -0.05112963699662302], [-0.0, -0.0, 0.0, -0.0, -0.0, -0.0, 0.0, 0.0, -0.0, 0.0  …  -0.0, -0.0, 0.0, -0.0, -0.0, -0.0, -0.0, 0.0, 0.0, -0.051129636996622985], [-0.36493864296786244, -1.080085580916031, 0.054820081981463514, -0.5804314303862452, -0.9342700166749852, -0.49537402389335805, 1.007245921001935, 0.5372386388061996, -0.3163548861617431, 1.1775080407210818  …  -1.2983040922875666, -0.15074931399488195, 1.1893294200104547, -0.3586923975239945, -0.14031678877669237, -0.7943712092471066, -0.27913088083327864, 0.3075249786310297, 0.026376144319648583, -3.4000000000000004], 9.862947041644958e-5, GeNIOS.GeNIOSLog{Float64, Vector{Float64}}([4.9290553605160845, 4.82281514537826, 4.670631505793923, 4.573946528042932, 4.5148897970282995, 4.471757993551566, 4.434624661600571, 4.403372659299845, 4.378264996801023, 4.355832403263281  …  0.0003823326298568525, 0.0003319543880878766, 0.00028704100405958007, 0.00024814137830617145, 0.00021513994739742338, 0.00018747143038903562, 0.00016427645277526507, 0.000144600785891119, 0.00012750871796187062, 0.00011235359357928348], [1386.2943611198643, 1372.5819881239627, 1350.0034011902774, 1333.8107525615221, 1325.0347660819177, 1320.3972925337566, 1317.7577933701189, 1316.0249373948545, 1314.7485287076343, 1313.6877789780913  …  1308.5533010155273, 1308.553289831798, 1308.5532815113816, 1308.5532753699147, 1308.5532708609912, 1308.5532675591217, 1308.5532651437284, 1308.5532633765908, 1308.553262082347, 1308.5532611328867], [0.148166668, 0.178862509, 0.21329146, 0.248156947, 0.284439651, 0.31776031, 0.352943123, 0.392991039, 0.428099346, 0.461143682  …  3.008410091, 3.071652828, 3.13810523, 3.453580951, 3.52108014, 3.589097613, 3.658479324, 3.721439913, 3.79243228, 3.86625242], [0.057507462, 0.01400336, 0.018398623, 0.01824651, 0.019109183, 0.017087914, 0.018520434, 0.0229542, 0.018551136, 0.017345336  …  0.047243412, 0.046249829, 0.049139068, 0.052579454, 0.050766703, 0.050950554, 0.052474575, 0.047423687, 0.055121032, 0.057904601], [4.5104e-5, 6.4205e-5, 3.5602e-5, 3.5103e-5, 3.7103e-5, 3.2102e-5, 3.4903e-5, 4.9704e-5, 3.8603e-5, 3.4403e-5  …  3.7603e-5, 3.8403e-5, 3.8903e-5, 4.1004e-5, 5.4705e-5, 4.0804e-5, 3.7803e-5, 3.4003e-5, 3.6904e-5, 4.8804e-5], [11.759986111315083, 12.58950767224293, 8.738059836285355, 4.764712804031012, 2.6425132514354446, 2.178344497756133, 2.0132638602989923, 1.6773964762172657, 1.2724873161315096, 0.8849002791983447  …  0.0012515335034778083, 0.0010443656160386372, 0.0008728123081424238, 0.0007282651471657114, 0.000606552968419705, 0.0005064908225531229, 0.0004260646875658929, 0.0003620860825955565, 0.0003110746387148377, 0.00026987949320244324], [42.08409560096439, 35.54033887208637, 32.085308907068196, 30.637927373863764, 29.712707044789582, 28.900483566807893, 28.226232894946484, 27.717992345728277, 27.328626088506002, 26.993316330130565  …  0.007193009288381974, 0.006168912396996954, 0.005273745017710954, 0.0045071551233315235, 0.0038600209762949035, 0.003318124408754973, 0.0028650098836559244, 0.002484128733240955, 0.0021600342450688783, 0.0018806622948741916], 0.575793775, 0.439583597, 3.939547409))</code></pre><h2 id="Results"><a class="docs-heading-anchor" href="#Results">Results</a><a id="Results-1"></a><a class="docs-heading-anchor-permalink" href="#Results" title="Permalink"></a></h2><pre><code class="language-julia hljs">rmse = sqrt(1/N*norm(A*solver.zk - b, 2)^2)
println(&quot;Final RMSE: $(round(rmse, digits=8))&quot;)
println(&quot;Dual gap: $(round(res.dual_gap, digits=8))&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Final RMSE: 0.59824024
Dual gap: 9.863e-5</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lasso/">« Lasso</a><a class="docs-footer-nextpage" href="../portfolio/">Markowitz Portfolio Optimization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 10 July 2023 15:18">Monday 10 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
