<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Logistic Regression · GeNIOS.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://tjdiamandis.github.io/GeNIOS.jl/examples/logistic/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeNIOS.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../constrained-ls/">Constrained Least Squares</a></li><li><a class="tocitem" href="../huber/">Huber Fitting</a></li><li><a class="tocitem" href="../lasso/">Lasso</a></li><li class="is-active"><a class="tocitem" href>Logistic Regression</a><ul class="internal"><li><a class="tocitem" href="#Generating-the-problem-data"><span>Generating the problem data</span></a></li><li><a class="tocitem" href="#Logistic-Solver"><span>Logistic Solver</span></a></li><li><a class="tocitem" href="#MLSolver-interface"><span>MLSolver interface</span></a></li><li><a class="tocitem" href="#Results"><span>Results</span></a></li></ul></li><li><a class="tocitem" href="../portfolio/">Markowitz Portfolio Optimization</a></li><li><a class="tocitem" href="../signal/">Signal Decomposition</a></li></ul></li><li><a class="tocitem" href="../../guide/">User Guide</a></li><li><a class="tocitem" href="../../method/">Solution method</a></li><li><a class="tocitem" href="../../api/">API reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Logistic Regression</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Logistic Regression</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tjdiamandis/GeNIOS.jl/blob/main/examples/logistic.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p>The source files for all examples can be found in <a href="https://github.com/tjdiamandis/GeNIOS.jl/tree/main/examples">/examples</a>.</p><h1 id="Logistic-Regression"><a class="docs-heading-anchor" href="#Logistic-Regression">Logistic Regression</a><a id="Logistic-Regression-1"></a><a class="docs-heading-anchor-permalink" href="#Logistic-Regression" title="Permalink"></a></h1><p>This example sets up a <span>$\ell_1$</span>-regularized logistic regression problem using the <code>MLSolver</code> interface provided by GeNIOS.</p><p>Specifically, we want to solve the problem</p><p class="math-container">\[\begin{array}{ll}
\text{minimize}     &amp; \sum_{i=1}^N \log(1 + \exp(a_i^T x)) + \gamma \|x\|_1
\end{array}\]</p><pre><code class="language-julia hljs">using GeNIOS
using Random, LinearAlgebra, SparseArrays</code></pre><h2 id="Generating-the-problem-data"><a class="docs-heading-anchor" href="#Generating-the-problem-data">Generating the problem data</a><a id="Generating-the-problem-data-1"></a><a class="docs-heading-anchor-permalink" href="#Generating-the-problem-data" title="Permalink"></a></h2><pre><code class="language-julia hljs">Random.seed!(1)
N, n = 2_000, 4_000
Ã = sprandn(N, n, 0.2)
@views [normalize!(Ã[:, i]) for i in 1:n-1]
Ã[:,n] .= 1.0

xstar = zeros(n)
inds = randperm(n)[1:100]
xstar[inds] .= randn(length(inds))
b̃ = sign.(Ã*xstar + 1e-1 * randn(N))
b = zeros(N)
A = Diagonal(b̃) * Ã

γmax = norm(0.5*A&#39;*ones(N), Inf)
γ = 0.05*γmax</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.7000000000000002</code></pre><h2 id="Logistic-Solver"><a class="docs-heading-anchor" href="#Logistic-Solver">Logistic Solver</a><a id="Logistic-Solver-1"></a><a class="docs-heading-anchor-permalink" href="#Logistic-Solver" title="Permalink"></a></h2><p>The easiest way to solve this problem is to use our <code>LogisticSolver</code> interface.</p><pre><code class="language-julia hljs">λ1 = γ
λ2 = 0.0
solver = GeNIOS.LogisticSolver(λ1, λ2, A, b)
res = solve!(solver; options=GeNIOS.SolverOptions(use_dual_gap=true, dual_gap_tol=1e-4, verbose=true))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GeNIOS.GeNIOSResult{Float64}(:OPTIMAL, 1308.5532677947854, 1097.4042550801346, [-5.55103857407304e-5, -1.7459686931338164e-5, 4.5089620118643055e-7, -2.548018411463003e-5, -2.340415214660385e-5, -2.4253347667156166e-5, -4.61167275859042e-6, 1.499738531180797e-5, -9.8380556854011e-6, 5.396115645130512e-5  …  -1.2840614499823754e-5, -8.119487911739505e-6, -1.2595467272125589e-5, 8.710894157375124e-5, 4.153148024367959e-5, -8.729048375164127e-6, 2.158984277468095e-6, 1.769126898381586e-5, 2.504002530901626e-5, -0.05113207102845215], [-0.0, -0.0, 0.0, -0.0, -0.0, -0.0, 0.0, 0.0, -0.0, 0.0  …  -0.0, -0.0, 0.0, -0.0, -0.0, -0.0, -0.0, 0.0, 0.0, -0.051132071028452186], [-0.18237133426501248, -0.5400496903606395, 0.027349399283118907, -0.2902041137939262, -0.46710626783082654, -0.24768370667471612, 0.5036542519516266, 0.26857297942866143, -0.1582097671763188, 0.5888109265648158  …  -0.649155012552651, -0.07532597959367054, 0.5946521315545497, -0.17946779511508634, -0.07021522224253474, -0.3971795503807564, -0.1395928477046095, 0.15373446083680484, 0.013121131703202676, -1.7000000000000002], 9.594056683447964e-5, GeNIOS.GeNIOSLog{Float64, Vector{Float64}}([4.9290553605160845, 4.809681275872365, 4.650000494038557, 4.577548314763731, 4.535189966600983, 4.502666108168744, 4.482284687405112, 4.44670594107021, 4.407185001206602, 4.385429489173054  …  0.0002728538870690267, 0.00025283268040188564, 0.00023747584611629897, 0.00022382955856911575, 0.0002093501270704484, 0.00019269361573359136, 0.00017379674150755085, 0.0001532699105695472, 0.00013227648835823237, 0.00011273631051051431], [1386.2943611198643, 1369.1987292837446, 1342.8537270233383, 1327.823475244775, 1321.7173321265025, 1318.4364553892128, 1316.6102512939196, 1315.130037071908, 1314.1895416081504, 1313.5822942742648  …  1308.5533341958112, 1308.5533196239116, 1308.553307967219, 1308.5532986269907, 1308.5532911110186, 1308.5532850291784, 1308.5532800797862, 1308.5532760341741, 1308.553272720236, 1308.5532700089243], [0.121901448, 0.149203226, 0.179958314, 0.211280104, 0.243080995, 0.275048586, 0.302695265, 0.334201255, 0.366822849, 0.394175227  …  2.812760617, 2.860266855, 2.906661291, 2.951977827, 2.996311062, 3.039945797, 3.083810531, 3.128430667, 3.178357406, 3.228535546], [0.050412644, 0.013065838, 0.016865349, 0.01715845, 0.01748765, 0.017695151, 0.013456538, 0.01743195, 0.017902451, 0.013083038  …  0.031438825, 0.032714825, 0.031621825, 0.030959124, 0.030645925, 0.029747624, 0.029847824, 0.030466924, 0.035313128, 0.035814028], [11.76462170490228, 14.05690455098738, 10.549343479795393, 6.217106056574151, 4.032661928881865, 3.683702223865327, 3.8396223716286455, 3.6676782454860803, 3.2015288368654082, 2.5081286973365207  …  0.0035523223827102837, 0.0030463165575226984, 0.003185222344169589, 0.0033682988985155953, 0.0032535073607802955, 0.00281847022506665, 0.002205126406753103, 0.0016426367802104566, 0.0013710309407436744, 0.00139971661915815], [42.08325550311181, 34.95567812499967, 31.72987172177724, 30.9758377701808, 30.3344151662569, 29.396818805077462, 28.469913371627978, 27.675049058333386, 27.10633481810182, 26.75170541290713  …  0.012165677064872663, 0.011193022133858522, 0.009562251418872493, 0.007807481583392869, 0.006547538501292566, 0.0060518422409197, 0.005975170438352871, 0.005804372186047203, 0.005300501489678787, 0.004509902958360528], 0.61202965, 0.535295731, 3.278826986))</code></pre><h2 id="MLSolver-interface"><a class="docs-heading-anchor" href="#MLSolver-interface">MLSolver interface</a><a id="MLSolver-interface-1"></a><a class="docs-heading-anchor-permalink" href="#MLSolver-interface" title="Permalink"></a></h2><p>Under the hood, the LogisticSolver is just a wrapper around the MLSolver interface. We can see what it&#39;s doing below. To use the <code>MLSolver</code> interface, we just need to specify <span>$f$</span> and the regularization parameters. We also define the conjugate function <span>$f^*$</span>, defined as</p><p class="math-container">\[f^*(y) = \sup_x \{yx - f(x)\},\]</p><p>to use the dual gap convergence criterion.</p><pre><code class="language-julia hljs"># Logistic problem: min ∑ log(1 + exp(aᵢᵀx)) + γ||x||₁
f2(x) = GeNIOS.log1pexp(x)
df2(x) = GeNIOS.logistic(x)
d2f2(x) = GeNIOS.logistic(x) / GeNIOS.log1pexp(x)
f2conj(x::T) where {T} = (one(T) - x) * log(one(T) - x) + x * log(x)
λ1 = γ
λ2 = 0.0
solver = GeNIOS.MLSolver(f2, df2, d2f2, λ1, λ2, A, b; fconj=f2conj)
res = solve!(solver; options=GeNIOS.SolverOptions(use_dual_gap=true, dual_gap_tol=1e-4, verbose=true))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GeNIOS.GeNIOSResult{Float64}(:OPTIMAL, 1308.5532677216997, 1097.4039810992122, [-5.064358097592897e-5, -2.106597071746078e-5, -1.3395670021775315e-6, -2.6830721645906717e-5, -2.4326459205575336e-5, -2.22071469380167e-5, -2.1329680749197246e-6, 1.543714384484934e-5, -8.452982007290691e-6, 5.1048884453967906e-5  …  -1.3773077509218416e-5, -8.007191445991631e-6, -1.6168250958176618e-5, 8.416732143938079e-5, 3.736702249705926e-5, -8.962731952988385e-6, 1.4255575364746572e-6, 1.6276461730873335e-5, 2.4573461691954446e-5, -0.05113209943273861], [-0.0, -0.0, 0.0, -0.0, -0.0, -0.0, 0.0, 0.0, -0.0, 0.0  …  -0.0, -0.0, 0.0, -0.0, -0.0, -0.0, -0.0, 0.0, 0.0, -0.051132099432738665], [-0.18236128510675567, -0.540048308476723, 0.027340750963639228, -0.29020713115132263, -0.467111530763692, -0.24768518557027386, 0.5036458875984677, 0.2685820958592579, -0.15821423967451265, 0.5888024132385242  …  -0.6491668690822454, -0.07532467559637211, 0.5946420233053051, -0.17947277881694843, -0.07022011287960929, -0.39717237972485486, -0.13959520698625585, 0.15372110880021225, 0.013116792997400675, -1.7000000000000002], 9.365959511386066e-5, GeNIOS.GeNIOSLog{Float64, Vector{Float64}}([4.9290553605160845, 4.807858666944419, 4.647829496635453, 4.575652946853985, 4.533699689145835, 4.500855248377982, 4.481301526086035, 4.446168289626408, 4.406244692663856, 4.3848306856773975  …  0.0002647146915717564, 0.0002482908728632538, 0.00023622105776412654, 0.00022479867617922046, 0.00021141011752509305, 0.00019472265536124838, 0.00017525650341827567, 0.0001538203458047312, 0.00013153403330128517, 0.0001110151228954951], [1386.2943611198643, 1369.2356382473783, 1342.885761258858, 1327.8338911049707, 1321.7127997012885, 1318.4264924998076, 1316.5988919992715, 1315.1289577893506, 1314.1901773647219, 1313.585532482467  …  1308.5533337177146, 1308.5533192851804, 1308.553307728188, 1308.553298452354, 1308.5532909731583, 1308.5532849098204, 1308.553279969473, 1308.5532759302216, 1308.5532726239182, 1308.5532699230573], [0.123628552, 0.150925429, 0.183116921, 0.215574213, 0.248969308, 0.282298203, 0.310210182, 0.343006175, 0.374850466, 0.402207744  …  2.798396457, 2.842856183, 2.88745911, 2.931607836, 2.97526976, 3.018085382, 3.062266207, 3.105829131, 3.153152366, 3.201026802], [0.050563043, 0.013088638, 0.01773165, 0.018001451, 0.018509852, 0.018600553, 0.013682939, 0.018296953, 0.01761345, 0.013262937  …  0.030950488, 0.030576987, 0.030866088, 0.030277086, 0.030049885, 0.029161083, 0.030022085, 0.029789685, 0.033511196, 0.033982196], [11.759986111315083, 14.055803401233128, 10.549118046482475, 6.213282328910097, 4.029122809926335, 3.6841934463725816, 3.8389630770278904, 3.6712734119000263, 3.203840945419082, 2.5096850676705187  …  0.0035989369233323425, 0.003040313555840893, 0.00309518359224962, 0.003248809107730556, 0.003155047087908873, 0.0027659652140995515, 0.0021990950616115955, 0.0016583072854549875, 0.0013656652357627822, 0.001358877255116677], [42.08409560096439, 34.9438182222933, 31.716661116158317, 30.966035298889903, 30.327517314277607, 29.386829256549028, 28.463194121919187, 27.668331251607942, 27.09634659581809, 26.743566267594783  …  0.011865752207679863, 0.010993670112420736, 0.009499143132299735, 0.007841845993438182, 0.006582415755448447, 0.00600445049554262, 0.005854590346337117, 0.005669072377473272, 0.0051971041216102324, 0.004457562439729183], 0.494121254, 0.4261588, 3.250941944))</code></pre><h2 id="Results"><a class="docs-heading-anchor" href="#Results">Results</a><a id="Results-1"></a><a class="docs-heading-anchor-permalink" href="#Results" title="Permalink"></a></h2><pre><code class="language-julia hljs">rmse = sqrt(1/N*norm(A*solver.zk - b, 2)^2)
println(&quot;Final RMSE: $(round(rmse, digits=8))&quot;)
println(&quot;Dual gap: $(round(res.dual_gap, digits=8))&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Final RMSE: 0.59813263
Dual gap: 9.366e-5</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lasso/">« Lasso</a><a class="docs-footer-nextpage" href="../portfolio/">Markowitz Portfolio Optimization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 7 June 2023 22:16">Wednesday 7 June 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
